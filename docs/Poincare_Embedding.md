# Poincare Embedding
Poincaré Embeddings for
Learning Hierarchical Representations.   
https://arxiv.org/pdf/1705.08039


### Abstruct
ユークリッドベクトル空間での埋め込みは潜在的な階層構造を表現することができない
→ 双曲空間(Hyperbolic Space),正確にはn次元ポアンカレ球へ埋め込みを行うことで表現する
🌟階層性(hierarchy)と類似性(similarity)を同時に捉えることができ、記号データの簡潔な表現学習を可能にする

🌟リーマン最適化に基づいた効率的な埋め込み学習アルゴリズムを導入

🌟ポアンカレ埋め込みが表現能力と汎化能力の両面でユークリッド埋め込みを大幅に上回ることを実験的に示す

### 1. Introduction
単語埋め込みの例： WORD2VEC、GLOVE、FASTTEXT

潜在空間埋め込みの例： NODE2VEC、DEEPWALK

多関係データの埋め込み： RESCAL、TRANSE、Universal Schema
→知識グラフ補完や情報抽出に利用

埋め込み手法の目的
埋め込み空間におけるそれらの類似性が意味的または機能的な類似性を反映するように配置すること.   
→埋め込み空間内での**距離または内積**

埋め込みの課題→ 次元数によって能力が制限される、法外に大きな次元数が必要

🌟ユークリッド空間ではなく双曲空間、すなわち一定の負の曲率を持つ空間に埋め込みを計算する.    

ポアンカレ球モデルに基づいた実装.    
→リーマン最適化に基づいた効率的な埋め込み計算アルゴリズムを開発でき流。このアルゴリズムは並列化が容易で、大規模なデータセットにもスケールする。

🌟WORDNETで学習させた埋め込みが、語彙的含意関係の推定タスクで最先端の性能を達成する

### 2. Embeddings and Hyperbolic Geometry
双曲幾何学(Hyperbolic geometry)は、定負曲率の空間を研究する非ユークリッド幾何学(non-Euclidean geometry)の一分野.    

例) 木を距離空間に埋め込む.   
→子の数は木の根からの距離に対して指数関数的に増加する.   
双曲幾何学(Hyperbolic geometry)では、これらのノードを2次元で簡単にモデル化できる！！
→双曲空間では円盤の面積と円周の長さがその半径に対して指数関数的に増大するから

ユークリッド空間では同様の構成は不可能。なぜなら、ユークリッド幾何学における円周の長さ（2πr）と円盤の面積（πr^2）は、半径 r に対してそれぞれ線形および2次でしか増加しないから。     
→より複雑な階層をモデル化するには、埋め込みの次元数を増やす必要がある！過学習につながる可能性もある

関連研究.    
機械学習と人工知能の分野では、ユークリッド埋め込みが記号データから学習するための一般的なアプローチ。
後で調べる: Holographic Embeddings, Complex Embeddings, Gaussian embeddings, Order Embeddings

### 3. Poincare Embeddings
🌟 埋め込み空間における距離がその意味的類似性を反映するような埋め込みを見つける
→ 潜在的な階層が存在すると仮定

改善目標1:     
埋め込み空間の構造に適切なバイアスをかけることで、より簡潔な埋め込み (parsimonious embeddings) を学習し、優れた汎化性能と、実行時間およびメモリ計算量の削減を目指す。

改善目標2:
埋め込み空間内で階層を明示的に捉えることで、記号間の関係や個々の記号の重要性について、さらなる洞察を得る。

🌟 階層関係を完全に教師なしで推論する.    
(we consider the task of inferring the hierarchical relationships
fully unsupervised)

双曲空間 H に埋め込みを行う。    
Beltrami-Klein model, the hyperboloid model, and the Poincaré half-plane model などいろいろ存在している。    
勾配法に基づく最適化に適している **Poincaré ball model** を採用。
![definition](docs/photos/definition.png "definition")

階層構造は一般的に2次元で表現できるのでポアンカレ円盤 (B^2)で表現できるはずだが、ここではポアンカレ球 (B^d)を用いる。
→ 複数の潜在的な階層が共存する可能性があり、これらは必ずしも2次元でモデル化できるとは限らないから.     
→埋め込みの次元数を大きくすると、最適化プロセスにおける自由度が増加するため、（単一の階層の場合でも）最適化手法が良い埋め込みを見つけるのが容易になる

**損失関数についてあとで完成させる**

### 3.1. Optimization
ポアンカレ球はリーマン多様体構造を持つため、損失関数は RSGD (Riemannian Stochastic Gradient Descent)や RSVRGといった確率的リーマン最適化の手法を用いて最適化できる。

**難しいからあとで**
→コードを参考にした方が早いかも？？？

### 3.2. Training Details
学習に関する以下のような詳細な設定が重要。

1. すべての埋め込みベクトルを一様分布 U(−0.001,0.001) からランダムに初期化.    
これにより、埋め込みはポアンカレ球(B^d)の原点近くで初期化される。

2. 初期段階における良好な角度的配置（angular layout）
学習の初期段階である「バーンイン（準備期間）」フェーズでは、学習率を η/c に低減して学習。原点近くでの初期化と組み合わせることで、これにより（ポアンカレ球の）境界に向かって移動しすぎることなく、角度的配置を改善することができる。c=10 と設定し、バーンイン期間を10エポックとする。

### 4. Evaluation
Poincareの性能評価のために他の埋め込みとも精度を比較している
スコア関数だけを変えている？？    
Euclidean → d(u,v)=∥u−v∥^2  
Translational → d(u,v)=∥u−v+r∥^2  

