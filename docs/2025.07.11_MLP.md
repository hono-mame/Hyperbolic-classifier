## This week's progress

### TODO
- [ ] soleve NaN problem

### solve NaN problem
Tried changing the number of hidden layers and the activation function (ActName) to see if that prevents the NaN values.

```haskell

 MLPHypParams device 400 [(1000,Relu),(200,Relu), (1,Id)]

Loading embeddings...
Loading training data...
Initializing model...
Training...
inputs shape in trainMLP: [6523,400]
targets shape in trainMLP: [6523,1]
Iter 1: Loss = 60.135674
Iter 2: Loss = NaN
```

```haskell
MLPHypParams device 400 [(1000,Selu),(200,Selu), (1,Id)]

Loading embeddings...
Loading training data...
Initializing model...
Training...
inputs shape in trainMLP: [6523,400]
targets shape in trainMLP: [6523,1]
Iter 1: Loss = 40.274372
Iter 2: Loss = NaN
```

```haskell
MLPHypParams device 400 [(1000,Elu),(200,Elu), (1,Id)]

Loading embeddings...
Loading training data...
Initializing model...
Training...
inputs shape in trainMLP: [6523,400]
targets shape in trainMLP: [6523,1]
Iter 1: Loss = 51.302326
Iter 2: Loss = NaN
```
I tried changing the number of hidden layers to 256, 64 (with an input of 400 and an output of 1), and also tried changing the activation function (ActName). However, all attempts still resulted in NaN values at iter2.


**Added implementation to output the vector assigned to each word:** 
```haskell
Total words in embedding: 12
First 10 words in embedding:
勧誘
善
変わる
恭敬
教諭
気象学
水路
温かさ
育ち上る
行なわれる
Loading training data...
===== Sample Word Embeddings (first 10) =====
Hyper: 食付く, Embedding (first 5): [-0.991739,0.433873,-1.634327,-2.637119,1.87341]
Hypo : 水路, Embedding (first 5): [-0.591747,0.450768,-0.569417,-1.819948,1.233053]
Label: [0.0]
-------------------------------------------
Hyper: 気象学, Embedding (first 5): [1.452248,4.2669e-2,-1.314564,1.0381e-2,2.714643]
Hypo : 育ち上る, Embedding (first 5): [1.570539,0.394597,-2.445322,-2.895358,1.70258]
Label: [0.0]
-------------------------------------------
Hyper: 防止, Embedding (first 5): [0.860323,0.364299,-1.338088,-2.240771,1.269506]
Hypo : 善, Embedding (first 5): [-0.550911,1.442538,-1.497971,-3.820506,-0.579182]
Label: [1.0]
-------------------------------------------
Hyper: 教諭, Embedding (first 5): [-2.908279,0.234655,-0.807588,-4.26368,2.062142]
Hypo : 変わる, Embedding (first 5): [0.456306,0.220344,-2.7309,-2.613384,1.505659]
Label: [0.0]
-------------------------------------------
Hyper: 温かさ, Embedding (first 5): [0.557453,-1.057253,-0.392746,0.620759,0.986158]
Hypo : 恭敬, Embedding (first 5): [-3.341663,1.490729,1.415666,-5.043354,2.632028]
Label: [1.0]
-------------------------------------------
Hyper: 行なわれる, Embedding (first 5): [2.602264,-2.635719,-2.582198,-2.742836,-1.908443]
Hypo : 持ち上る, Embedding (first 5): [0.0,0.0,0.0,0.0,0.0] [ZERO VECTOR!]
Label: [1.0]
-------------------------------------------
Hyper: 勧誘, Embedding (first 5): [2.167533,1.266657,-0.277014,0.605125,4.747177]
Hypo : 烙印, Embedding (first 5): [0.0,0.0,0.0,0.0,0.0] [ZERO VECTOR!]
Label: [0.0]
-------------------------------------------
Hyper: 捨去る, Embedding (first 5): [0.0,0.0,0.0,0.0,0.0] [ZERO VECTOR!]
Hypo : 現像, Embedding (first 5): [0.0,0.0,0.0,0.0,0.0] [ZERO VECTOR!]
Label: [0.0]
-------------------------------------------
Hyper: 事業年度, Embedding (first 5): [0.0,0.0,0.0,0.0,0.0] [ZERO VECTOR!]
Hypo : 嫌疑者, Embedding (first 5): [0.0,0.0,0.0,0.0,0.0] [ZERO VECTOR!]
Label: [0.0]
-------------------------------------------
```

It seems that words existing within the embedding are properly assigned vectors. Even after removing pairs that result in a 0-vector and re-running, the issue of getting NaN values from iter2 onwards was not resolved. This problem seems like it will take some time to fix, so for now, I'll proceed with implementing Hyperbolic Embedding.